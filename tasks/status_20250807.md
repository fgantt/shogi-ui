<state_snapshot>
    <overall_goal>
        Develop a browser-based Shogi game with an AI opponent, customizable settings, and a good user experience, specifically enabling flexible player type selection (Human/AI for both Player 1 and Player 2) and fixing related bugs.
    </overall_goal>

    <key_knowledge>
        - Shogi rules are understood and documented.
        - The AI uses a minimax algorithm with alpha-beta pruning and an opening book.
        - The opening book (`src/ai/openingBook.json`) maps SFEN-like board hashes to moves.
        - The UI is built with React components.
        - `PLAYER_1` and `PLAYER_2` constants define the players.
        - `getInitialGameState()` in `src/game/engine.js` sets the default board with Player 1 to move.
        - `StartGameModal.jsx` handles initial game settings.
        - `App.jsx` manages overall game state, player types, and interactions.
        - `player1Type` and `player2Type` state variables in `App.jsx` determine if a player is 'human' or 'ai'.
        - `generateStateHash` in `src/game/engine.js` is crucial for repetition detection and now correctly hashes the board state, captured pieces, and current player.
        - Player labels in captured pieces panels are dynamic: "Black" or "White" (English) / "Sente" or "Gote" (Kanji).
        - Shogi piece symbols (☗ for Black/Sente, <span style="color: white;">☗</span> for White/Gote) are used as prefixes for player labels.
        - Move history table now has 3 columns: Move Number, Player 1 Move, Player 2 Move.
        - Move history table auto-scrolls to the latest move.
        - A red line is drawn between the checking piece and the king when the king is in check.
    </key_knowledge>

    <file_system_state>
        - MODIFIED: `src/game/engine.js` - Added `getCheckingPiece` function and updated `isKingInCheck`.
        - MODIFIED: `src/App.jsx` - Added `checkingPiece` state and passed it to the `Board` component.
        - MODIFIED: `src/components/Board.jsx` - Added logic to render a red line between the checking piece and the king.
        - MODIFIED: `src/styles/shogi.css` - Added styles for the check line SVG.
    </file_system_state>

    <recent_actions>
        - Implemented a feature to draw a red line between the checking piece and the king when the king is in check.
    </recent_actions>

    <current_plan>
        1. [TODO] Verify the check line feature works as expected.
    </current_plan>
</state_snapshot>